<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Porsche 911 Interactive</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            font-family: 'DM Mono', monospace;
            user-select: none; /* Prevent text selection */
            cursor: none; /* hide default cursor */
        }
        
        /* Mobile message overlay - HIDDEN by default */
        #mobile-message {
            display: none !important; /* Always hidden - mobile message is disabled */
            position: fixed;
            inset: 0;
            z-index: 99999; /* Above everything */
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            align-items: center;
            justify-content: center;
            flex-direction: column;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            margin: 0;
            padding: 0;
        }
        
        #mobile-message.active {
            display: none !important; /* Keep it hidden even with active class */
        }
        
        #mobile-message-text {
            color: #ffd700;
            font-size: 24px;
            text-align: center;
            padding: 40px;
            line-height: 1.6;
            font-weight: 700;
            /* Ensure text itself is centered */
            width: 100%;
            max-width: 90%;
            box-sizing: border-box;
        }
        
        /* Hide all UI elements on mobile */
        body.mobile #cursor-cross,
        body.mobile #tooltip,
        body.mobile #part-container,
        body.mobile .music-player,
        body.mobile .fullscreen-button,
        body.mobile .rotate-button,
        body.mobile .info-button,
        body.mobile #part-menu-overlay,
        body.mobile #loading-overlay {
            display: none !important;
        }
        
        /* Video intro overlay - shown on page load */
        #loading-overlay {
            position: fixed;
            inset: 0;
            z-index: 99999;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            clip-path: inset(0% 0% 0% 0%);
            pointer-events: auto; /* Block all interactions behind the video */
        }
        
        /* Interlace overlay above the video, below the Enter button */
        #loading-overlay::before { content: ""; display: none; }
        
        #loading-overlay.hidden {
            clip-path: inset(100% 0% 0% 0%);
            pointer-events: none;
        }
        

        #loading-video {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
            /* Video starts visible and playing, will be clipped when animation starts */
        }
        
        #enter-button {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 48px;
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid #ffd700;
            color: #ffd700;
            font-family: 'DM Mono', monospace;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer !important;
            transition: all 0.3s ease;
            z-index: 100000;
            backdrop-filter: blur(10px);
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        #loading-overlay {
            cursor: default !important;
        }
        
        #enter-button:hover {
            background: rgba(255, 215, 0, 0.2);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
            transform: translateX(-50%) scale(1.05);
        }
        
        #enter-button:active {
            transform: translateX(-50%) scale(0.98);
        }
        
        /* Canvas is visible but covered by video overlay - preloading happens underneath */
        #canvas-container {
            opacity: 0;
            visibility: visible; /* Visible but transparent so it can fade in */
            pointer-events: none !important; /* NEVER allow interactions until Enter is clicked */
            background: #000;
            position: relative;
            z-index: 1;
        }
        
        #canvas-container.loaded {
            opacity: 1;
            visibility: visible;
        }
        
        #canvas-container.loaded {
            pointer-events: auto !important;
        }
        
        body {
            background: #000;
        }
        
        canvas {
            display: block;
            cursor: none;
            pointer-events: none !important; /* Block all canvas interactions initially */
        }
        
        /* Enable canvas interactions only after Enter is clicked */
        #canvas-container.loaded canvas,
        canvas.ready {
            pointer-events: auto !important;
        }
        
        canvas:active {
            cursor: grabbing;
        }
        
        /* Block canvas interactions when video overlay is visible */
        #loading-overlay:not(.hidden) ~ * canvas,
        body:has(#loading-overlay:not(.hidden)) canvas {
            pointer-events: none !important;
        }
        /* ensure canvas sits behind overlays */
        #canvas-container {
            position: fixed;
            inset: 0;
            z-index: 0;
        }

        /* Yellow cross cursor - original CSS pseudo-elements with colors and simple drop-shadow */
        #cursor-cross {
            position: fixed;
            left: 0;
            top: 0;
            width: 50px;
            height: 50px;
            pointer-events: none;
            z-index: 10001; /* Higher than all overlays (10000 for out of funds, 9999 for part menu) to be visible on top */
            transform: translate(-50%, -50%);
            opacity: 0; /* Hidden initially */
            visibility: hidden; /* Hidden initially */
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        /* Show cursor only after Enter is clicked */
        #cursor-cross.show {
            opacity: 1;
            visibility: visible;
        }
        .wiki-lightbox-overlay.visible ~ #cursor-cross {
            z-index: 10003 !important; /* Cursor above lightbox when it's open */
        }
        #cursor-cross::before,
        #cursor-cross::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            background: #ffd700; /* neon yellow default */
            transform: translate(-50%, -50%);
            /* Simple drop-shadow for visibility */
            filter: drop-shadow(0 0 2px rgba(0, 0, 0, 0.8));
        }
        /* vertical bar */
        #cursor-cross::before {
            width: 2px;
            height: 50px;
        }
        /* horizontal bar */
        #cursor-cross::after {
            width: 50px;
            height: 2px;
        }
        /* Hovering state turns cross red */
        #cursor-cross.hovering::before,
        #cursor-cross.hovering::after {
            background: #ff0000;
        }
        
        /* Cursor color states */
        #cursor-cross.warning::before,
        #cursor-cross.warning::after {
            background: #ff4444; /* Red for warnings */
        }
        
        #cursor-cross.good::before,
        #cursor-cross.good::after {
            background: #44ff44; /* Green for good status */
        }
        
        #cursor-cross.neutral::before,
        #cursor-cross.neutral::after {
            background: #ffd700; /* Yellow for neutral status */
        }
        
        /* Tooltip styling */
        #tooltip {
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 1000;
            opacity: 0 !important; /* Force hidden by default */
            transition: opacity 0.2s ease;
            transform: translate(40px, -50%); /* Position 40px to the right of cursor */
        }
        
        #tooltip.visible {
            opacity: 1 !important; /* Force visible when class is added */
        }
        
        #tooltip-content {
            background: rgba(0, 0, 0, 0.7); /* 10% lower opacity (0.8 â†’ 0.7) */
            color: #ffd700; /* Yellow text */
            font-family: 'DM Mono', monospace;
            font-size: 14px;
            font-weight: 100;
            padding: 8px 12px;
            white-space: nowrap;
            border-radius: 8px; /* Small rounded corners */
            text-shadow: 
                0 0 5px rgba(255, 140, 0, 0.5),
                0 0 10px rgba(255, 140, 0, 0.3);
        }
        
        #tooltip-part-name {
            font-weight: 700; /* Bold */
            margin-bottom: 2px;
            font-size: 18px; /* ~13.5pt - increased from 16px (~12pt) */
            color: #ffd700; /* Default yellow */
        }
        
        #tooltip-part-name.warning {
            color: #ff4444; /* Red for warnings */
        }
        
        #tooltip-part-name.good {
            color: #44ff44; /* Green for good status */
        }
        
        #tooltip-status {
            font-size: 14px; /* Same size as part name */
            opacity: 1.0; /* Full opacity for status text */
        }
        
        #tooltip-status.warning {
            color: #ff4444; /* Red for maintenance warnings */
        }
        
        #tooltip-status.good {
            color: #44ff44; /* Green for good status */
        }
        
        /* Hard blink effect for status line */
        #tooltip-status.blinking {
            animation: none; /* Disable CSS animation, use JavaScript instead */
        }
        
        /* Tooltip icon styling */
        #tooltip-icon {
            width: 36px;
            height: 36px;
            margin-top: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        #tooltip-icon svg {
            width: 36px;
            height: 36px;
            stroke: #ffd700; /* Default yellow */
            stroke-width: 2;
            fill: none;
        }
        
        #tooltip-icon.warning svg {
            stroke: #ff4444; /* Red for warnings */
        }
        
        #tooltip-icon.good svg {
            stroke: #44ff44; /* Green for good status */
        }
        
        /* Hard blink effect for icon */
        #tooltip-icon.blinking {
            animation: none; /* Disable CSS animation, use JavaScript instead */
        }
        
        /* Music player styling */
        #music-player {
            position: fixed;
            top: 50px;
            right: 50px; /* Match left-side padding */
            width: 60px;
            height: 60px;
            background: transparent;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: none !important; /* Always use custom cursor */
            z-index: 1000;
            transition: transform 0.15s ease; /* never animate opacity */
        }
        
        #music-player:hover {
            background: transparent;
            transform: scale(1.2); /* Max hover scale */
            opacity: 1 !important; /* Prevent any opacity changes on hover */
        }
        #music-player:hover #music-icon svg {
            stroke: #ffe866; /* Brighter yellow on hover - same as important words in history page */
        }
        
        /* Lock opacity during any state changes */
        #music-player:focus,
        #music-player:active,
        #music-player:focus-visible { opacity: 1 !important; }
        
        #music-icon {
            width: 36px;
            height: 36px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: stroke 0.15s ease; /* faster color response */
        }
        
        #music-icon svg {
            width: 36px;
            height: 36px;
            stroke: #ffd700; /* Default yellow (not playing) */
            stroke-width: 2;
            fill: none;
        }
        
        #music-player.playing #music-icon svg {
            stroke: #ff4444; /* Red when playing (active state) */
        }
        
        /* Fullscreen button styling */
        #fullscreen-button {
            position: fixed;
            top: 50px;
            right: 130px; /* Increased spacing from music player */
            width: 60px;
            height: 60px;
            background: transparent;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: none !important; /* Always use custom cursor */
            z-index: 1000;
            transition: transform 0.15s ease;
        }
        
        #fullscreen-button:hover {
            background: transparent;
            transform: scale(1.2); /* Max hover scale */
            opacity: 1 !important; /* Prevent any opacity changes on hover */
        }
        #fullscreen-button:focus,
        #fullscreen-button:active,
        #fullscreen-button:focus-visible { opacity: 1 !important; }
        
        #fullscreen-icon {
            width: 36px;
            height: 36px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        #fullscreen-icon svg {
            width: 36px;
            height: 36px;
            stroke: #ffd700; /* Default yellow */
            stroke-width: 2;
            fill: none;
        }
        
        /* Brighter yellow on hover - same as important words in history page */
        #fullscreen-button:hover #fullscreen-icon svg { stroke: #ffe866; }

        /* UI staged fade-in */
        .ui-fade { opacity: 0; transition: opacity 0.8s ease; }
        .ui-fade.visible { opacity: 1; }
        
        /* Hide all UI elements initially - they'll fade in after 3D scene is ready */
        /* Using opacity: 0 without !important so GSAP can animate it */
        #tooltip,
        #music-player,
        #book-button,
        #rotate-button,
        #info-button,
        #fullscreen-button,
        #part-container {
            opacity: 0;
        }
        
        /* After fade-in completes, ensure these stay visible */
        #music-player.faded-in,
        #book-button.faded-in,
        #rotate-button.faded-in,
        #info-button.faded-in,
        #fullscreen-button.faded-in,
        #part-container.faded-in {
            opacity: 1 !important;
        }

        /* Rotate toggle button */
        #rotate-button {
            position: fixed;
            top: 50px;
            right: 290px; /* Increased spacing */
            width: 60px;
            height: 60px;
            background: transparent;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: none !important; /* Always use custom cursor */
            z-index: 1000;
            transition: transform 0.15s ease;
        }
        #rotate-button:hover { 
            transform: scale(1.2); /* Max hover scale */
            opacity: 1 !important; /* Prevent any opacity changes on hover */
        }
        #rotate-button:focus,
        #rotate-button:active,
        #rotate-button:focus-visible { opacity: 1 !important; }
        #rotate-button:hover #rotate-icon svg {
            stroke: #ffe866; /* Brighter yellow on hover - same as important words in history page */
        }
        #rotate-icon, #rotate-icon svg { width: 36px; height: 36px; }
        #rotate-icon svg { stroke: #ffd700; stroke-width: 2; fill: none; }
        #rotate-button.paused #rotate-icon svg { stroke: #ff4444; }

        /* Info toggle button */
        #info-button {
            position: fixed;
            top: 50px;
            right: 210px; /* Increased spacing */
            width: 60px;
            height: 60px;
            background: transparent;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: none !important; /* Always use custom cursor */
            z-index: 1000;
            transition: transform 0.15s ease;
        }
        #info-button:hover { 
            transform: scale(1.2); /* Max hover scale */
            opacity: 1 !important; /* Prevent any opacity changes on hover */
        }
        #info-button:focus,
        #info-button:active,
        #info-button:focus-visible { opacity: 1 !important; }
        #info-button:hover #info-icon svg {
            stroke: #ffe866; /* Brighter yellow on hover - same as important words in history page */
        }
        #info-icon, #info-icon svg { width: 36px; height: 36px; }
        #info-icon svg { stroke: #ffd700; stroke-width: 2; fill: none; }
        #info-button.off #info-icon svg { stroke: #ff4444; }
        
        /* Book button for Porsche history */
        #book-button {
            position: fixed;
            top: 50px;
            right: 370px; /* Increased spacing */
            width: 60px;
            height: 60px;
            background: transparent;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: none !important; /* Always use custom cursor */
            z-index: 1000;
            transition: transform 0.15s ease;
        }
        #book-button:hover { 
            transform: scale(1.2); /* Max hover scale */
            opacity: 1 !important; /* Prevent any opacity changes on hover */
        }
        #book-button:focus,
        #book-button:active,
        #book-button:focus-visible { opacity: 1 !important; }
        #book-button:hover #book-icon svg {
            stroke: #ffe866; /* Brighter yellow on hover - same as important words in history page */
        }
        #book-icon, #book-icon svg { width: 36px; height: 36px; }
        #book-icon svg { stroke: #ffd700; stroke-width: 2; fill: none; }
        
        @keyframes hardBlink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* Typewriter effect */
        .typewriter {
            overflow: hidden;
            border-right: 2px solid #ffd700;
            white-space: nowrap;
            animation: typing 0.5s steps(20, end), blink-caret 0.75s step-end infinite;
        }
        
        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }
        
        @keyframes blink-caret {
            from, to { border-color: transparent; }
            50% { border-color: #ffd700; }
        }

        /* Loading overlay */
        #loading-overlay {
            position: fixed;
            inset: 0;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            opacity: 1;
            transition: opacity 1.6s ease; /* longer fade out */
            pointer-events: all;
        }
        #loading-overlay.hidden { opacity: 0; pointer-events: none; }
        #loading-text {
            color: #ffd700;
            font-family: 'DM Mono', monospace;
            font-size: 12px; /* half size */
            letter-spacing: 4px;
            opacity: 1;
            animation: hardBlinkFast 0.4s steps(1, end) infinite; /* constant fast blink from frame 0 */
            animation-fill-mode: both;
        }
        @keyframes hardBlinkFast {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0; }
        }
        
        #part-container {
            position: fixed;
            top: 0;
            left: 0;
            padding: 50px;
            opacity: 0;
            z-index: 10; /* ensure overlay above canvas for backdrop-filter */
            isolation: isolate; /* create new stacking context for backdrop-filter */
            transform: scale(0.84); /* 5% larger than 0.8 */
            transform-origin: top left;
            pointer-events: none; /* never block mouse */
        }
        
        #part-container.visible {
            opacity: 1;
        }
        
        /* Ensure window is completely hidden when not visible */
        #part-container:not(.visible) {
            opacity: 0 !important;
            pointer-events: none;
        }
        
        #part-name {
            font-size: 39px; /* +10% from 35px (35 * 1.1 = 38.5, rounded to 39) */
            font-weight: 700; /* Bold instead of 100 */
            color: #ffd700; /* Default yellow */
            text-shadow: 
                0 0 10px rgba(255, 140, 0, 0.5),
                0 0 20px rgba(255, 140, 0, 0.3),
                0 0 30px rgba(255, 140, 0, 0.2);
            pointer-events: none;
            z-index: 1;
            text-align: left;
            letter-spacing: 2px;
            font-family: 'DM Mono', monospace;
            font-weight: bold;
            margin-bottom: 20px;
            padding-left: 16px; /* Align with divider lines below (same as part-info padding) */
        }
        
        #part-name.warning {
            color: #ff4444; /* Red for warnings */
            text-shadow: 
                0 0 10px rgba(255, 68, 68, 0.5),
                0 0 20px rgba(255, 68, 68, 0.3),
                0 0 30px rgba(255, 68, 68, 0.2);
        }
        
        #part-name.good {
            color: #44ff44; /* Green for good status */
            text-shadow: 
                0 0 10px rgba(68, 255, 68, 0.5),
                0 0 20px rgba(68, 255, 68, 0.3),
                0 0 30px rgba(68, 255, 68, 0.2);
        }
        
        #part-info {
            font-size: 16.5px; /* +10% from 15px */
            color: #ffd700;
            font-family: 'DM Mono', monospace;
            font-weight: 100;
            line-height: 1.5;
            pointer-events: none; /* never block mouse */
            z-index: 1;
            max-width: 40vw;
            max-height: 70vh;
            overflow-y: auto;
            white-space: pre-wrap;
            position: relative;
            background: transparent;
            border-radius: 8px; /* Small rounded corners */
            padding: 16px;
        }

        /* Remove pseudo-element blur layer */
        
        #part-info .info-line {
            display: block;
            opacity: 0;
            animation: slideIn 0.01s forwards;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Porsche History Overlay */
        #porsche-history-overlay {
            position: fixed;
            inset: 0;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            display: none;
        }
        #porsche-history-overlay.visible {
            display: block;
            pointer-events: all;
        }
        #porsche-history-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(4px); /* Increased from 2px for stronger blur effect */
            pointer-events: all;
        }
        #porsche-history-container {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 85vw;
            max-width: 900px; /* Larger than part menu (600px) */
            max-height: calc(100vh - 110px); /* 55px gap top and bottom (matches inner padding) */
            background: rgba(0, 0, 0, 0.5); /* 0.5 opacity black background */
            border: 1px solid #ffd700;
            border-radius: 0;
            padding: 55px; /* Slightly increased padding from window border to content */
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: visible; /* Allow full-width images to extend beyond padding */
            /* Centering handled by GSAP via transform */
            transform: translate(-50%, -50%);
        }
        #porsche-history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px; /* Reduced by 50% from 32px */
            padding-bottom: 10px; /* Reduced by 50% from 20px */
            border-bottom: none; /* Match part menu - no border */
            position: relative; /* No sticky positioning - no scroll interactions */
            padding-top: 0;
            margin-top: -16px; /* Moved up by 16px */
            /* Allow pointer events to pass through header to enable scrolling */
            pointer-events: none;
        }
        /* Re-enable pointer events on interactive elements within header */
        #porsche-history-title,
        #porsche-history-close {
            pointer-events: auto;
        }
        #porsche-history-title {
            font-family: 'DM Mono', monospace;
            font-size: 36px; /* Larger headline size */
            font-weight: bold;
            color: #ffd700;
            margin: 0;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            /* Initial hidden state for entry animation */
            opacity: 0;
            transform: translateY(10px);
            clip-path: inset(0 100% 0 0); /* Start: fully masked from left */
            overflow: hidden;
            position: relative;
        }
        #porsche-history-close {
            background: rgba(255, 215, 0, 0.1); /* Match part menu button */
            border: 2px solid #ffd700;
            color: #ffd700;
            font-size: 32px;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            cursor: none !important; /* Always use custom cursor */
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            padding: 0;
            transition: all 0.2s ease;
            pointer-events: auto; /* Enable clicks on close button */
        }
        #porsche-history-close:hover {
            background: #ffd700;
            color: #000;
            transform: scale(1.1);
        }
        #porsche-history-content {
            color: #ffd700;
            font-family: 'DM Mono', monospace; /* Space Mono Regular */
            font-size: 22px; /* 22pt body text */
            font-weight: 300; /* Light weight */
            line-height: 1.5;
            overflow-y: scroll; /* Enable scrolling */
            overflow-x: visible; /* Allow full-width images to bleed beyond padding */
            padding-left: 0; /* No padding here - container handles left padding */
            padding-right: 0; /* No right padding - scrollbar is outside */
            flex: 1;
            position: relative; /* Ensure positioning context for child elements */
            /* Create proper stacking context - content stays below sticky header */
            z-index: 0;
            isolation: isolate; /* Create new stacking context */
            /* Hide default scrollbar */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE and Edge */
        }
        #porsche-history-content::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera - hide default scrollbar */
        }
        /* Custom scrollbar positioned outside container */
        #porsche-history-scrollbar {
            position: fixed;
            width: 6px; /* Increased from 4px to make scrollbar taller */
            background: transparent; /* Removed black background, only yellow thumb visible */
            pointer-events: auto;
            z-index: 10001;
            /* Position will be calculated in JavaScript to be to the right of container */
            display: none; /* Hidden by default, shown when content scrolls */
        }
        #porsche-history-scrollbar-thumb {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 0;
            background: #ffd700;
            border-radius: 3px; /* Increased from 2px to match taller scrollbar */
            cursor: none !important; /* Always use custom cursor */
            transition: background 0.15s ease;
        }
        #porsche-history-scrollbar-thumb:hover {
            background: #ffed4e;
        }
        #porsche-history-content h3 {
            color: #ffd700;
            font-family: 'DM Mono', monospace; /* Space Mono for headings too */
            font-size: 28px; /* Larger headings */
            font-weight: 700; /* Bold weight */
            margin-top: 40px;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        #porsche-history-content p,
        #porsche-history-content h3 {
            margin-bottom: 20px;
            overflow: hidden; /* Needed for clip-path animation */
            position: relative; /* Needed for clip-path animation */
            opacity: 0; /* Start hidden for scroll reveal */
            transform: translateY(20px); /* Start further below for extended slide-up animation */
            clip-path: inset(0 100% 0 0); /* Start: fully masked from left (for mask reveal animation) */
            /* No CSS transition - GSAP handles all animations */
        }
        #porsche-history-content em {
            font-style: italic;
            font-size: 20px; /* Slightly larger for emphasis */
        }
        #porsche-history-content p strong {
            font-weight: 300; /* Same lighter weight as body text */
            color: #ffe866; /* 25% brighter than #ffd700 - keeps emphasis through color */
        }
        .porsche-history-done-button {
            margin-top: 0; /* No margin - container handles spacing, matches buy button */
            padding: 16px 24px; /* Match part menu option padding */
            background: rgba(255, 215, 0, 0.1); /* Match part menu option neutral state */
            border: 1px solid #ffd700; /* Match part menu option border */
            border-radius: 0; /* Match part menu option - no rounded corners */
            color: #ffd700; /* Match part menu option color */
            font-family: 'DM Mono', monospace; /* Match part menu font */
            font-size: 20px; /* Match part menu option font size */
            font-weight: 400; /* Match part menu option font weight */
            text-align: center; /* Center aligned */
            cursor: none !important; /* Always use custom cursor */
            transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease, transform 0.2s ease;
            opacity: 0;
            transform: translateY(20px); /* Match part menu option initial transform */
            flex: 1; /* Split the space equally between buttons */
            position: relative;
            line-height: normal; /* Ensure consistent line-height */
        }
        .porsche-history-done-button.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .porsche-history-done-button:hover {
            background: #ffd700 !important; /* Match part menu option hover */
            color: #000 !important; /* Match part menu option hover */
            border-color: #ffd700 !important;
            transform: translateX(8px) translateY(0); /* Match part menu option hover transform */
        }
        .porsche-history-stock-chart {
            margin-top: 0; /* No margin - spacing handled by separator margin-bottom */
            margin-bottom: 0; /* No margin - buttons directly below */
            width: 100%;
            background: transparent; /* Remove dark background - use main container background */
            border: none; /* Remove yellow border */
            padding: 20px 0; /* Keep vertical padding, remove horizontal to stretch */
            position: relative;
        }
        .porsche-history-stock-chart-separator {
            width: 100%;
            height: 1px;
            background: #ffd700; /* Full opacity default yellow */
            margin-top: 0; /* No margin - spacing handled by paragraph margin-bottom */
            margin-bottom: 12px; /* Closer spacing to chart title */
        }
        .porsche-history-stock-chart-title {
            color: #ffd700;
            font-family: 'DM Mono', monospace;
            font-size: 17px; /* Increased from 14px */
            font-weight: 400;
            margin-bottom: 16px;
            opacity: 0;
            transform: translateY(10px);
        }
        .porsche-history-stock-chart-title.visible {
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }
        .porsche-history-stock-chart canvas {
            width: 100%;
            aspect-ratio: 16 / 9; /* 16:9 aspect ratio */
            display: block;
            opacity: 0;
            transform: translateY(10px);
            image-rendering: crisp-edges;
        }
        .porsche-history-stock-chart canvas.visible {
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.6s ease 0.2s, transform 0.6s ease 0.2s;
        }
        .porsche-history-stock-chart-legend {
            display: flex;
            gap: 32px;
            margin-top: 16px;
            font-family: 'DM Mono', monospace;
            font-size: 12px;
            color: rgba(255, 215, 0, 0.8);
            opacity: 1; /* Always visible - no fade in needed */
            transform: translateY(0);
        }
        .porsche-history-stock-chart-legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .porsche-history-stock-chart-legend-line {
            width: 40px;
            height: 2px;
            background: #00ff88; /* Green solid line for Porsche */
        }
        .porsche-history-stock-chart-legend-line.sp500 {
            background: transparent;
            border-top: 2px dashed rgba(255, 215, 0, 0.5); /* Dashed yellow line for S&P 500 */
        }
        .porsche-history-buttons {
            display: flex;
            flex-direction: row;
            gap: 12px; /* Split in the middle between buttons */
            margin-top: 62px; /* Standard spacing from chart above (matches standard distance) */
            width: 100%; /* Stretch to fill window width */
        }
        .porsche-history-buy-button {
            margin-top: 0; /* Reset margin, handled by buttons container - match done button exactly */
            padding: 16px 24px; /* Match done button padding exactly */
            background: rgba(255, 215, 0, 0.1); /* Match done button neutral state */
            border: 1px solid #ffd700; /* Match done button border */
            border-radius: 0; /* Match done button - no rounded corners */
            color: #ffd700; /* Match done button color */
            font-family: 'DM Mono', monospace; /* Match done button font */
            font-size: 20px; /* Match done button font size */
            font-weight: 400; /* Match done button font weight */
            text-align: center; /* Center aligned text */
            cursor: none !important; /* Always use custom cursor */
            transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease, transform 0.2s ease;
            opacity: 0;
            transform: translateY(20px); /* Match done button initial transform */
            flex: 1; /* Split the space equally between buttons */
            position: relative;
            line-height: normal; /* Ensure line-height matches */
        }
        .porsche-history-buy-button.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .porsche-history-buy-button:hover {
            background: #ffd700 !important; /* Match part menu option hover */
            color: #000 !important; /* Match part menu option hover */
            border-color: #ffd700 !important;
            transform: translateX(8px) translateY(0); /* Match part menu option hover transform */
        }
        /* Image placeholder boxes */
        .porsche-history-image-placeholder {
            width: 100%;
            aspect-ratio: 16 / 9; /* Standard image ratio */
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid #ffd700;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 30px 0;
            color: #ffd700;
            font-family: 'DM Mono', monospace;
            font-size: 14px;
            font-weight: 300;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }
        .porsche-history-image-placeholder.visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Image and caption wrapper */
        .porsche-history-image-wrapper {
            width: 80%; /* 80% of reading text width */
            margin-top: 62px; /* Match spacing below caption (synced vertical whitespace) */
            margin-bottom: 0; /* No bottom margin, handled by caption */
            margin-left: auto;
            margin-right: auto;
        }
        /* Actual image boxes */
        .porsche-history-image {
            width: 100%; /* Full width of wrapper */
            aspect-ratio: 16 / 9; /* Standard image ratio */
            margin: 0; /* No margin, handled by wrapper */
            opacity: 1; /* Container visible so yellow block shows through */
            transform: translateY(0); /* No initial transform */
            transition: opacity 0.6s ease, transform 0.6s ease;
            overflow: hidden;
            position: relative;
            /* Don't clip the container - clip the image itself */
        }
        /* Yellow placeholder block that appears before images */
        .porsche-history-image-placeholder-block {
            position: absolute;
            top: 0;
            left: 0;
            width: calc(100% - 1px); /* 1px smaller to prevent pixel leaks */
            height: calc(100% - 1px); /* 1px smaller to prevent pixel leaks */
            background: #ffd700; /* Solid yellow */
            z-index: 1; /* Behind image */
            clip-path: inset(0 100% 0 0); /* Start: fully masked from left */
            opacity: 1; /* Visible initially */
            pointer-events: none; /* Don't block clicks on images */
        }
        /* Image should start above placeholder */
        .porsche-history-image img {
            position: relative;
            z-index: 2; /* Above placeholder */
            clip-path: inset(0 100% 0 0); /* Start: fully masked from left */
            pointer-events: auto; /* Enable clicks on images */
        }
        /* Videos should start above placeholder but NOT be clickable */
        .porsche-history-image video {
            position: relative;
            z-index: 2; /* Above placeholder */
            clip-path: inset(0 100% 0 0); /* Start: fully masked from left */
            pointer-events: none !important; /* Disable clicks on videos */
            cursor: default !important; /* No pointer cursor on videos */
        }
        /* Looping interlace effect overlay on images */
        .porsche-history-image::before {
            pointer-events: none; /* Don't block clicks */
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: repeating-linear-gradient(
                0deg,
                transparent 0px,
                transparent 1px,
                rgba(0, 0, 0, 0.25) 1px,
                rgba(0, 0, 0, 0.25) 2px
            );
            pointer-events: none;
            z-index: 3; /* Above image (z-index: 2) so interlace is on top */
            animation: interlaceMove 0.1s linear infinite;
        }
        @keyframes interlaceMove {
            0% {
                transform: translateY(0);
            }
            100% {
                transform: translateY(2px);
            }
        }
        .porsche-history-image.visible {
            opacity: 1;
            transform: translateY(0);
            clip-path: inset(0 0% 0 0); /* End: fully revealed */
            transition: opacity 0.6s cubic-bezier(0.85, 0, 0.15, 1), transform 0.6s cubic-bezier(0.85, 0, 0.15, 1), clip-path 0.8s cubic-bezier(0.85, 0, 0.15, 1); /* Sharp quant ease */
        }
        .porsche-history-image img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Crop to fit the box */
            display: block;
            max-width: 1200px; /* Reasonable max width - images are displayed at 80% of text width anyway (~720px max) */
            pointer-events: auto; /* Enable clicks on images */
            cursor: none !important; /* Always use custom cursor */
            transition: transform 0.3s ease; /* Smooth scale animation */
        }
        .porsche-history-image img:hover {
            transform: scale(1.08); /* Scale up slightly on hover */
        }
        /* Videos in regular images should NOT be clickable */
        .porsche-history-image video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            max-width: 1200px;
            pointer-events: none !important; /* Disable clicks on videos */
            cursor: default !important; /* No pointer cursor on videos */
        }
        /* Specifically block porsche 9000 thumbnail (pfuture-video) */
        .porsche-history-image video[src*="pfuture-video"],
        .porsche-history-image video[data-no-lightbox="true"] {
            pointer-events: none !important;
            cursor: default !important;
        }
        /* Block clicks on the wrapper containing porsche 9000 video */
        .porsche-history-image-wrapper:has(video[src*="pfuture-video"]),
        .porsche-history-image-wrapper:has(video[data-no-lightbox="true"]) {
            pointer-events: none !important;
            cursor: default !important;
        }
        /* Fallback for browsers that don't support :has() */
        .porsche-history-image-wrapper .porsche-history-image:has(video[src*="pfuture-video"]),
        .porsche-history-image-wrapper .porsche-history-image:has(video[data-no-lightbox="true"]) {
            pointer-events: none !important;
            cursor: default !important;
        }
        /* Videos in fullwidth images should NOT be clickable */
        .porsche-history-fullwidth-image video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            pointer-events: none !important; /* Disable clicks on videos */
            cursor: default !important; /* No pointer cursor on videos */
        }
        /* Specifically block porsche 9000 thumbnail (pfuture-video) in fullwidth too */
        .porsche-history-fullwidth-image video[src*="pfuture-video"],
        .porsche-history-fullwidth-image video[data-no-lightbox="true"] {
            pointer-events: none !important;
            cursor: default !important;
        }
        .porsche-history-image img {
            /* animation: imageFlicker 0.05s linear infinite alternate; /* DISABLED - Fast flicker between 1.0 and 0.98 opacity */
            animation: none; /* Flicker effect turned off */
        }
        @keyframes imageFlicker {
            0% {
                opacity: 1.0;
            }
            100% {
                opacity: 0.98;
            }
        }
        /* Pause all animations when overlay is hidden - saves CPU when not viewing article */
        #porsche-history-overlay:not(.visible) .porsche-history-image img {
            animation-play-state: paused;
        }
        /* Pause video playback when overlay is hidden */
        #porsche-history-overlay:not(.visible) .porsche-history-image video {
            animation-play-state: paused;
        }
        #porsche-history-overlay:not(.visible) .porsche-history-image::before {
            animation-play-state: paused;
        }
        .porsche-history-image-caption {
            margin-top: 8px;
            margin-bottom: 62px; /* Match spacing above image (matches wrapper margin-top) */
            margin-left: 0; /* Align with image left edge - same container */
            width: 100%; /* Full width of wrapper, same as image */
            font-family: 'DM Mono', monospace; /* Space Mono Regular */
            font-size: 14px; /* Same size as full-width image caption */
            font-weight: 400; /* Regular weight */
            color: #ffd700; /* Solid yellow at full opacity */
            text-align: left; /* Left align to match image */
            font-style: italic;
            opacity: 0;
            transform: translateY(10px);
            overflow: hidden;
            position: relative;
            clip-path: inset(0 100% 0 0); /* Start: masked from left (same as image) */
            transition: opacity 0.6s ease, transform 0.6s ease, clip-path 0.8s cubic-bezier(0.85, 0, 0.15, 1);
        }
        .porsche-history-image-caption.visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Full-width parallax images in article */
        .porsche-history-fullwidth-image {
            /* Full width of content area, with parallax effect */
            position: relative;
            width: 100%;
            margin-top: 62px; /* Match spacing above smaller images */
            margin-bottom: 62px; /* Match spacing below smaller images */
            overflow: hidden;
            /* 1920x1280 (3:2) aspect ratio for visible area */
            aspect-ratio: 3 / 2;
            will-change: transform;
            /* Force GPU acceleration for smoother clipping */
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
            /* Ensure it stays below sticky header - lower z-index */
            z-index: 0; /* Stay within content's stacking context */
            /* Ensure it doesn't conflict with sticky header - create isolated layer */
            position: relative;
        }
        /* Yellow placeholder block for full-width images */
        .porsche-history-fullwidth-image-placeholder-block {
            position: absolute;
            top: 0;
            left: 0;
            width: calc(100% - 1px); /* 1px smaller to prevent pixel leaks */
            height: calc(100% - 1px); /* 1px smaller to prevent pixel leaks */
            background: #ffd700; /* Solid yellow */
            z-index: 1; /* Behind image */
            clip-path: inset(0 100% 0 0); /* Start: fully masked from left */
            opacity: 1; /* Visible initially */
        }
        /* Full-width image should start above placeholder */
        .porsche-history-fullwidth-image img {
            position: relative;
            z-index: 2; /* Above placeholder */
            width: 100%;
            display: block;
            /* Extra height for parallax - 150% of container height (50% extra for parallax movement) */
            height: 150%;
            object-fit: cover;
            object-position: center center; /* Center the image - expands from center */
            /* Center the image vertically - position top edge so center of image is at center of container */
            top: -25%; /* Move up by half of extra height (25% of container = half of 50% extra) to center */
            transform-origin: center center; /* Ensure transforms happen from center */
            will-change: transform, clip-path; /* Optimize for parallax animation and clip-path */
            /* Prevent edge artifacts during parallax */
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            clip-path: inset(0 100% 0 0); /* Start: fully masked from left, so yellow shows through */
            pointer-events: auto; /* Enable clicks on images */
        }
        /* Full-width videos should start above placeholder but NOT be clickable */
        .porsche-history-fullwidth-image video {
            position: relative;
            z-index: 2; /* Above placeholder */
            width: 100%;
            display: block;
            /* Extra height for parallax - 150% of container height (50% extra for parallax movement) */
            height: 150%;
            object-fit: cover;
            object-position: center center; /* Center the image - expands from center */
            /* Center the image vertically - position top edge so center of image is at center of container */
            top: -25%; /* Move up by half of extra height (25% of container = half of 50% extra) to center */
            transform-origin: center center; /* Ensure transforms happen from center */
            will-change: transform, clip-path; /* Optimize for parallax animation and clip-path */
            /* Prevent edge artifacts during parallax */
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            clip-path: inset(0 100% 0 0); /* Start: fully masked from left, so yellow shows through */
            pointer-events: none !important; /* Disable clicks on videos */
            cursor: default !important; /* No pointer cursor on videos */
        }
        .porsche-history-fullwidth-image img {
            /* animation: imageFlicker 0.05s linear infinite alternate; /* DISABLED */
            animation: none; /* Flicker effect turned off */
        }
        /* Caption overlay on full-width parallax image */
        .porsche-history-fullwidth-image-caption {
            position: absolute;
            bottom: 20px; /* Padding from bottom */
            left: 20px; /* Padding from left */
            max-width: 60%; /* Don't span entire width, leave space */
            font-family: 'DM Mono', monospace; /* Space Mono Regular */
            font-size: 14px; /* Slightly larger than regular captions */
            font-weight: 400; /* Regular weight */
            color: #ffd700; /* Yellow text */
            padding: 16px 20px; /* Nice padding similar to other elements */
            line-height: 1.6;
            z-index: 3; /* Above image effects */
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.8); /* Additional text shadow for readability */
        }
        /* Pause full-width image animations when overlay is hidden */
        #porsche-history-overlay:not(.visible) .porsche-history-fullwidth-image img {
            animation-play-state: paused;
        }
        /* Pause video playback when overlay is hidden */
        #porsche-history-overlay:not(.visible) .porsche-history-fullwidth-image video {
            animation-play-state: paused;
        }
        /* Interlace effect overlay on full-width images */
        .porsche-history-fullwidth-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: repeating-linear-gradient(
                0deg,
                transparent 0px,
                transparent 1px,
                rgba(0, 0, 0, 0.25) 1px,
                rgba(0, 0, 0, 0.25) 2px
            );
            pointer-events: none;
            z-index: 3; /* Above image (z-index: 2) so interlace is on top */
            animation: interlaceMove 0.1s linear infinite;
            /* Ensure proper clipping */
            clip-path: inset(0);
            -webkit-clip-path: inset(0);
        }
        #porsche-history-overlay:not(.visible) .porsche-history-fullwidth-image::before {
            animation-play-state: paused;
        }
        
        /* Out of Funds Overlay - styled like part menu but red */
        #out-of-funds-overlay {
            position: fixed;
            inset: 0;
            z-index: 10000;
            opacity: 0;
            pointer-events: none;
            display: none;
            cursor: none !important;
        }
        #out-of-funds-overlay.visible {
            display: block;
            pointer-events: all;
            cursor: none !important;
        }
        /* Wiki Image Lightbox */
        .wiki-lightbox-overlay {
            position: fixed;
            inset: 0;
            z-index: 10002; /* Above wiki window (10000) */
            display: none;
            align-items: center;
            justify-content: center;
        }
        .wiki-lightbox-overlay.visible {
            display: flex;
            cursor: none !important; /* Always use custom cursor */
        }
        .wiki-lightbox-overlay * {
            cursor: none !important; /* All elements inside lightbox use custom cursor */
        }
        .wiki-lightbox-overlay.visible ~ #cursor-cross,
        .wiki-lightbox-overlay.visible #cursor-cross {
            z-index: 10003 !important; /* Cursor above lightbox images */
        }
        #wiki-lightbox-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(4px);
            cursor: none !important; /* Always use custom cursor */
            opacity: 1;
            transition: opacity 0.2s ease-out, backdrop-filter 0.2s ease-out;
        }
        .wiki-lightbox-overlay.closing #wiki-lightbox-backdrop {
            opacity: 0 !important;
            backdrop-filter: blur(0px) !important;
        }
        #wiki-lightbox-container {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
            cursor: none !important; /* Always use custom cursor */
        }
        #wiki-lightbox-image,
        #wiki-lightbox-video {
            width: 100%;
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
            border: none; /* Remove yellow stroke */
            box-shadow: none; /* Remove yellow drop shadow */
            filter: blur(20px); /* Start blurred for animation */
            transform: scale(0.9); /* Start smaller for animation */
            opacity: 0; /* Start invisible */
            transition: filter 0.4s ease, transform 0.4s ease; /* No opacity transition to prevent flicker */
            position: relative; /* Position above background */
            z-index: 2; /* Above background, below buttons */
        }
        /* Blurred background duplicate */
        #wiki-lightbox-image-bg,
        #wiki-lightbox-video-bg {
            position: absolute;
            inset: 0;
            width: 150%; /* Scale up 50% */
            height: 150%; /* Scale up 50% */
            object-fit: cover;
            filter: blur(50px); /* Extreme Gaussian blur */
            opacity: 0; /* Start at 0 for ambilight effect */
            transition: opacity 2s ease-out !important; /* Slow 2s fade in with ease-out curve for ambilight - important to override inline styles */
            z-index: 1; /* Above backdrop but below main image and buttons */
            pointer-events: none; /* Don't block clicks */
            transform: translate(-16.67%, -16.67%); /* Center the 150% scaled image */
        }
        .wiki-lightbox-overlay.closing #wiki-lightbox-image-bg,
        .wiki-lightbox-overlay.closing #wiki-lightbox-video-bg {
            opacity: 0 !important;
            transition: opacity 0.2s ease-out !important; /* Quick fade out */
        }
        .wiki-lightbox-overlay.visible #wiki-lightbox-image-bg.loaded,
        .wiki-lightbox-overlay.visible #wiki-lightbox-video-bg.loaded {
            opacity: 1.0 !important; /* Fade to full opacity over 2s with ease-out for ambilight effect */
        }
        #wiki-lightbox-image.loaded,
        #wiki-lightbox-video.loaded {
            filter: blur(0px) !important; /* Clear blur */
            transform: scale(1) !important; /* Full size */
            opacity: 1 !important; /* Fully visible - no opacity change during navigation */
            transition: filter 0.25s ease, transform 0.25s ease; /* Smooth transitions (no opacity transition) */
        }
        .wiki-lightbox-overlay.closing #wiki-lightbox-image,
        .wiki-lightbox-overlay.closing #wiki-lightbox-video {
            filter: blur(10px) !important;
            transform: scale(0.95) !important;
            opacity: 0 !important;
            transition: filter 0.2s ease-out, transform 0.2s ease-out, opacity 0.2s ease-out;
        }
        .wiki-lightbox-close {
            position: absolute;
            top: 20px; /* Moved up closer */
            right: 20px; /* Closer to edge */
            background: transparent; /* No background */
            border: none; /* No border */
            color: #ffd700;
            font-size: 28px; /* Smaller, simpler */
            width: 32px; /* Smaller */
            height: 32px; /* Smaller */
            cursor: none !important; /* Always use custom cursor */
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            padding: 0;
            transition: all 0.2s ease;
            z-index: 3; /* Above blurry background and main image */
            font-family: 'DM Mono', monospace;
            font-weight: 400;
        }
        .wiki-lightbox-close:hover {
            color: #fff;
            transform: scale(1.2);
        }
        .wiki-lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid #ffd700;
            color: #ffd700;
            font-size: 36px;
            width: 48px;
            height: 48px;
            cursor: none !important; /* Always use custom cursor */
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            padding: 0;
            transition: all 0.2s ease;
            z-index: 3; /* Above blurry background and main image */
            font-family: 'DM Mono', monospace;
            font-weight: 400;
        }
        .wiki-lightbox-nav:hover {
            background: rgba(255, 215, 0, 0.2);
            color: #fff;
            transform: translateY(-50%) scale(1.1);
        }
        .wiki-lightbox-nav-left {
            left: 20px;
        }
        .wiki-lightbox-nav-right {
            right: 20px;
        }
        .wiki-lightbox-nav:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
        }
        #out-of-funds-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(4px); /* Increased to match other popups */
            pointer-events: all;
        }
        #out-of-funds-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90vw;
            max-width: 600px;
            background: rgba(0, 0, 0, 0.75);
            border: 1px solid #ff4444;
            border-radius: 0;
            padding: 32px;
            box-shadow: 0 0 40px rgba(255, 68, 68, 0.3);
            /* GSAP will animate y property, so we need to support it */
        }
        #out-of-funds-header {
            margin-bottom: 32px;
            padding-bottom: 0;
            border-bottom: none;
        }
        #out-of-funds-title {
            font-family: 'DM Mono', monospace;
            font-size: 32px;
            font-weight: 400;
            color: #ff4444;
            margin: 0;
            text-align: left;
        }
        #out-of-funds-content {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        #out-of-funds-button {
            padding: 16px 24px;
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid #ff4444;
            border-radius: 0;
            color: #ff4444;
            font-family: 'DM Mono', monospace;
            font-size: 20px;
            font-weight: 400;
            cursor: none !important; /* Always use custom cursor */
            transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease, transform 0.2s ease;
            width: fit-content;
        }
        #out-of-funds-button:hover {
            background: #ff4444 !important;
            color: #000 !important;
            border-color: #ff4444 !important;
            transform: translateX(8px);
        }
        
        /* Part Menu Overlay */
        #part-menu-overlay {
            position: fixed;
            inset: 0;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            display: none; /* Hidden by default */
            cursor: none !important; /* Force hide OS cursor */
        }
        #part-menu-overlay.visible {
            display: block; /* Show when visible */
            pointer-events: all;
            cursor: none !important; /* Force hide OS cursor when visible */
        }
        /* Force hide cursor on body and all elements when menu is open */
        body.menu-open,
        body.menu-open * {
            cursor: none !important;
        }
        #part-menu-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.1); /* Much lighter - almost no darkening */
            backdrop-filter: blur(4px); /* Increased to match wiki window */
            pointer-events: all; /* Allow clicks through backdrop */
        }
        #part-menu-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90vw;
            max-width: 600px;
            background: rgba(0, 0, 0, 0.75); /* Pure black at 0.75 opacity */
            border: 1px solid #ffd700; /* 1px stroke like other lines */
            border-radius: 0; /* No rounded corners */
            padding: 32px;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
        }
        #part-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px; /* Match container padding for even spacing */
            padding-bottom: 0; /* Remove padding since no border */
            border-bottom: none; /* Remove fine line between headline and buttons */
        }
        #part-menu-title {
            font-family: 'DM Mono', monospace;
            font-size: 34px; /* +10% from 31px (31 * 1.1 = 34.1, rounded to 34) */
            font-weight: bold;
            color: #ffd700;
            margin: 0;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        #part-menu-close {
            background: rgba(255, 215, 0, 0.1); /* Match button neutral state */
            border: 2px solid #ffd700;
            color: #ffd700;
            font-size: 32px;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            cursor: none !important; /* Always use custom cursor */
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            padding: 0;
            transition: all 0.2s ease;
        }
        #part-menu-close:hover {
            background: #ffd700;
            color: #000;
            transform: scale(1.1);
        }
        #part-menu-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .part-menu-option {
            padding: 16px 24px;
            background: rgba(255, 215, 0, 0.1); /* Neutral state */
            border: 1px solid #ffd700; /* Solid yellow with no opacity */
            border-radius: 0; /* No rounded corners */
            cursor: none !important; /* Always use custom cursor */
            font-family: 'DM Mono', monospace;
            font-size: 20px; /* Increased by ~25% from 16px (16 * 1.25 = 20) */
            color: #ffd700; /* Neutral state - yellow text */
            opacity: 0;
            transform: translateY(20px);
            transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
            position: relative;
        }
        /* Hover: shift headline and icon to the right */
        .part-menu-option:hover .part-menu-option-title {
            transform: translateX(8px); /* Subtle shift to the right */
            transition: transform 0.2s ease;
        }
        /* Warning icon moves with title (inside title element) - no separate transform */
        .part-menu-option:hover .warning-icon-wrapper {
            transform: translateX(0); /* Icon is inside title, so it moves with title */
            transition: transform 0.2s ease;
        }
        /* Hover: shift subtitle with delay */
        .part-menu-option:hover .part-menu-option-desc {
            transform: translateX(8px); /* Subtle shift to the right */
            transition: transform 0.2s ease 0.1s; /* 0.1s delay for staggered effect */
        }
        .part-menu-option .part-menu-option-title {
            transition: transform 0.2s ease; /* Return to default position when not hovered */
        }
        .part-menu-option .warning-icon-wrapper {
            transition: transform 0.2s ease; /* Return to default position when not hovered */
        }
        .part-menu-option .part-menu-option-desc {
            transition: transform 0.2s ease; /* Return to default position when not hovered */
        }
        .part-menu-option:hover {
            background: #ffd700 !important; /* Solid yellow on hover */
            color: #000 !important; /* Black text on hover */
            border-color: #ffd700 !important;
        }
        /* Warning option (damaged parts) - red instead of yellow */
        .part-menu-option.warning-option {
            background: rgba(255, 68, 68, 0.1); /* Red background for damaged parts - match yellow button opacity */
            border: 1px solid #ff4444; /* Red border */
            color: #ff4444; /* Red text */
        }
        .part-menu-option.warning-option:hover {
            background: #ff4444 !important; /* Solid red on hover */
            color: #000 !important; /* Black text on hover */
            border-color: #ff4444 !important;
        }
        .part-menu-option:hover .part-menu-option-title,
        .part-menu-option:hover .part-menu-option-desc {
            color: #000 !important; /* Ensure text is black on hover */
        }
        /* Warning option text should be red (non-hover state) */
        .part-menu-option.warning-option .part-menu-option-title,
        .part-menu-option.warning-option .part-menu-option-desc {
            color: #ff4444; /* Red text for damaged parts */
        }
        /* Warning icon styling using feather icons */
        .part-menu-option.warning-option .warning-icon-wrapper {
            display: inline-block;
            margin-right: 8px;
        }
        /* Red warning triangle for damaged parts (neutral state) */
        .part-menu-option.warning-option .warning-icon-wrapper .warning-icon-feather {
            width: 18px;
            height: 18px;
            stroke: #ff4444; /* Red for damaged parts */
            stroke-width: 2;
            fill: none;
        }
        /* Black warning triangle on hover (red button) */
        .part-menu-option.warning-option:hover .warning-icon-wrapper .warning-icon-feather {
            stroke: #000; /* Black on hover */
        }
        .part-menu-option-title {
            font-weight: 700;
            margin-bottom: 4px;
            font-size: 20px; /* Match container font size */
            display: inline-block; /* Allow transform to work properly */
        }
        .part-menu-option-desc {
            font-size: 14px; /* Increased from 12px for better readability */
            opacity: 0.7;
            font-weight: 100;
        }
    </style>
</head>
<body>
    <!-- Mobile message overlay -->
    <div id="mobile-message">
        <div id="mobile-message-text">im sorry this is for real computers only - no phones</div>
    </div>
    <div id="part-container">
        <div id="part-name"></div>
        <div id="part-info"></div>
    </div>
    <div id="cursor-cross" class="ui-fade"></div>
            <div id="loading-overlay">

            <video id="loading-video" autoplay loop muted playsinline preload="metadata" poster="Media/782-hdri-skies-com/hdri_sky_782.jpg">
                <source src="Media/herointro.mp4" type="video/mp4">
            </video>
            <button id="enter-button">Enter</button>
        </div>
    <div id="tooltip" class="ui-fade">
        <div id="tooltip-content">
            <div id="tooltip-part-name"></div>
            <div id="tooltip-status"></div>
            <div id="tooltip-icon"></div>
        </div>
    </div>
    <div id="music-player" class="ui-fade">
        <div id="music-icon"></div>
    </div>
    <div id="book-button" class="ui-fade">
        <div id="book-icon"></div>
    </div>
    <div id="rotate-button" class="ui-fade">
        <div id="rotate-icon"></div>
    </div>
    <div id="info-button" class="ui-fade">
        <div id="info-icon"></div>
    </div>
    <div id="fullscreen-button" class="ui-fade">
        <div id="fullscreen-icon"></div>
    </div>
    <!-- Porsche History Overlay -->
    <div id="porsche-history-overlay">
        <div id="porsche-history-backdrop"></div>
            <div id="porsche-history-container">
                <div id="porsche-history-header">
                    <h2 id="porsche-history-title">Porsche: The Cult of Precision</h2>
                    <button id="porsche-history-close">&times;</button>
                </div>
                <div id="porsche-history-content"></div>
            </div>
            <div id="porsche-history-scrollbar">
                <div id="porsche-history-scrollbar-thumb"></div>
            </div>
    </div>
    
    <!-- Out of Funds Overlay -->
    <div id="out-of-funds-overlay">
        <div id="out-of-funds-backdrop"></div>
        <div id="out-of-funds-container">
            <div id="out-of-funds-header">
                <h2 id="out-of-funds-title">OUT OF FUNDS</h2>
            </div>
            <div id="out-of-funds-content">
                <button id="out-of-funds-button">GET BACK TO WORK</button>
            </div>
        </div>
    </div>
    <!-- Part Menu Overlay -->
    <div id="part-menu-overlay">
        <div id="part-menu-backdrop"></div>
        <div id="part-menu-container">
            <div id="part-menu-header">
                <h2 id="part-menu-title"></h2>
                <button id="part-menu-close">&times;</button>
            </div>
            <div id="part-menu-options"></div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
        }
    }
    </script>
    <!-- Lightbox for wiki images -->
    <div id="wiki-image-lightbox" class="wiki-lightbox-overlay">
        <div id="wiki-lightbox-backdrop" class="backdrop"></div>
        <div id="wiki-lightbox-container">
            <button id="wiki-lightbox-close" class="wiki-lightbox-close">Ã—</button>
            <button id="wiki-lightbox-prev" class="wiki-lightbox-nav wiki-lightbox-nav-left">â€¹</button>
            <button id="wiki-lightbox-next" class="wiki-lightbox-nav wiki-lightbox-nav-right">â€º</button>
            <img id="wiki-lightbox-image-bg" src="" alt="" style="display: none;">
            <img id="wiki-lightbox-image" src="" alt="">
            <video id="wiki-lightbox-video" src="" autoplay loop muted playsinline style="display: none;"></video>
        </div>
    </div>
    
    <div id="canvas-container"></div>
    <!-- Preload 3D experience immediately so it's ready when Enter is clicked -->
    <script type="module" src="main.min.js"></script>
    <script type="module">
        const params = new URLSearchParams(window.location.search);
        if (params.get('legacy') !== '1') {
            import('./src/app.js');
        }
    </script>
    <!-- Handle Enter button to reveal the preloaded experience -->
    <script>
        // Handle Enter button click to start the experience
        document.addEventListener('DOMContentLoaded', () => {
            const loadingOverlay = document.getElementById('loading-overlay');
            const enterButton = document.getElementById('enter-button');
            const canvasContainer = document.getElementById('canvas-container');
            const loadingVideo = document.getElementById('loading-video');
            
            if (enterButton && loadingOverlay) {
                // Prevent main.js from hiding the overlay automatically
                // Override any attempts to hide it until Enter is clicked
                let enterClicked = false;
                
                // Monitor and prevent overlay from being hidden
                const observer = new MutationObserver(() => {
                    if (!enterClicked && loadingOverlay) {
                        // If overlay gets hidden in any way, show it again (unless Enter was clicked)
                        if (loadingOverlay.classList.contains('hidden') || 
                            loadingOverlay.style.display === 'none' ||
                            loadingOverlay.style.visibility === 'hidden' ||
                            loadingOverlay.style.opacity === '0') {
                            loadingOverlay.classList.remove('hidden');
                            loadingOverlay.style.display = 'flex';
                            loadingOverlay.style.visibility = 'visible';
                            loadingOverlay.style.opacity = '1';
                        }
                    }
                });
                
                observer.observe(loadingOverlay, {
                    attributes: true,
                    attributeFilter: ['class', 'style'],
                    childList: false,
                    subtree: false
                });
                
                // ABSOLUTE protection - video overlay MUST stay visible until Enter is clicked
                // Check very frequently and aggressively override ANY attempts to hide it
                let protectInterval = setInterval(() => {
                    if (enterClicked) {
                        clearInterval(protectInterval);
                        return;
                    }
                    
                    if (loadingOverlay) {
                        // Check if overlay still exists in DOM
                        if (!loadingOverlay.parentNode && document.body) {
                            // Overlay was removed! Add it back immediately
                            console.warn('Video overlay was removed from DOM! Restoring...');
                            document.body.appendChild(loadingOverlay);
                        }
                        
                        // Aggressively maintain visibility - override ANY hiding attempts
                        const computedStyle = window.getComputedStyle(loadingOverlay);
                        
                        if (loadingOverlay.style.display === 'none' || 
                            computedStyle.display === 'none' ||
                            loadingOverlay.style.visibility === 'hidden' ||
                            computedStyle.visibility === 'hidden' ||
                            loadingOverlay.style.opacity === '0' ||
                            parseFloat(computedStyle.opacity) < 0.5 ||
                            loadingOverlay.classList.contains('hidden')) {
                            
                            loadingOverlay.classList.remove('hidden');
                            loadingOverlay.style.setProperty('display', 'flex', 'important');
                            loadingOverlay.style.setProperty('visibility', 'visible', 'important');
                            loadingOverlay.style.setProperty('opacity', '1', 'important');
                            loadingOverlay.style.setProperty('z-index', '99999', 'important');
                            loadingOverlay.style.setProperty('pointer-events', 'auto', 'important');
                            loadingOverlay.style.setProperty('position', 'fixed', 'important');
                            loadingOverlay.style.setProperty('top', '0', 'important');
                            loadingOverlay.style.setProperty('left', '0', 'important');
                            loadingOverlay.style.setProperty('width', '100%', 'important');
                            loadingOverlay.style.setProperty('height', '100%', 'important');
                        }
                        
                        // Also ensure canvas container cannot receive pointer events
                        if (canvasContainer) {
                            canvasContainer.style.setProperty('pointer-events', 'none', 'important');
                        }
                    } else {
                        // Overlay doesn't exist? Recreate it!
                        console.error('Video overlay element is missing!');
                    }
                }, 20); // Check very frequently - every 20ms
                
                // Block ALL mouse/touch events from reaching anything behind the overlay
                // BUT allow clicks on the Enter button to work
                const blockAllEvents = (e) => {
                    // Don't block if clicking on the Enter button
                    if (enterButton && (e.target === enterButton || enterButton.contains(e.target))) {
                        return; // Allow Enter button to receive events
                    }
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    e.preventDefault();
                };
                
                // Capture ALL events on the overlay (capture phase to catch them first)
                const eventTypes = ['mousedown', 'mouseup', 'mousemove', 'mouseenter', 'mouseleave', 
                                   'click', 'dblclick', 'touchstart', 'touchmove', 'touchend',
                                   'pointerdown', 'pointermove', 'pointerup', 'wheel', 'contextmenu'];
                
                eventTypes.forEach(eventType => {
                    loadingOverlay.addEventListener(eventType, blockAllEvents, true); // true = capture phase
                    if (eventType !== 'click') { // Don't double-block click in bubble phase (button needs it)
                        loadingOverlay.addEventListener(eventType, blockAllEvents, false); // false = bubble phase
                    }
                });
                
                // Also block events on the video element itself (but not button)
                if (loadingVideo) {
                    eventTypes.forEach(eventType => {
                        if (eventType !== 'click') {
                            loadingVideo.addEventListener(eventType, blockAllEvents, true);
                            loadingVideo.addEventListener(eventType, blockAllEvents, false);
                        }
                    });
                }
                
                // Ensure video starts playing - let native loop attribute handle looping
                if (loadingVideo) {
                    loadingVideo.loop = true;
                    loadingVideo.muted = true;
                    loadingVideo.playsInline = true;
                    
                    // Just start playing - the loop attribute will handle looping natively
                    loadingVideo.play().catch(err => {
                        console.log('Video autoplay failed, user interaction required:', err);
                    });
                    
                    // Ensure video keeps playing - prevent it from freezing/pausing
                    const keepVideoPlaying = setInterval(() => {
                        if (enterClicked) {
                            clearInterval(keepVideoPlaying);
                            return;
                        }
                        if (loadingVideo && loadingVideo.paused && !loadingVideo.ended) {
                            loadingVideo.play().catch(() => {}); // Ignore errors
                        }
                    }, 100); // Check every 100ms
                }
                
                // Aggressively block canvas/3D scene interactions
                const blockCanvasInteractions = () => {
                    if (enterClicked) {
                        // After Enter is clicked, stop blocking
                        return;
                    }
                    
                    // Find all canvas elements and block them
                    const canvases = document.querySelectorAll('canvas');
                    canvases.forEach(canvas => {
                        canvas.style.setProperty('pointer-events', 'none', 'important');
                        canvas.style.setProperty('user-select', 'none', 'important');
                        canvas.classList.remove('ready'); // Remove ready class
                    });
                    
                    // Also block the canvas container
                    if (canvasContainer) {
                        canvasContainer.style.setProperty('pointer-events', 'none', 'important');
                    }
                };
                
                // Block canvas interactions immediately and continuously
                blockCanvasInteractions();
                let canvasBlockerInterval = setInterval(() => {
                    if (enterClicked) {
                        clearInterval(canvasBlockerInterval);
                        // DON'T enable canvas interactions here - wait until scene fade-in/camera zoom completes
                        // Interactions will be enabled in the scene fade-in onComplete callback
                        return;
                    }
                    blockCanvasInteractions();
                }, 50);
                
                enterButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    
                    enterClicked = true;
                    observer.disconnect(); // Stop preventing hide after Enter is clicked
                    clearInterval(protectInterval);
                    if (typeof canvasBlockerInterval !== 'undefined') {
                        clearInterval(canvasBlockerInterval);
                    }
                    
                    // Show the custom cursor now that Enter is clicked
                    const cursorCross = document.getElementById('cursor-cross');
                    if (cursorCross) {
                        cursorCross.classList.add('show');
                    }
                    
                    // Use GSAP to animate clip-path with smooth easing
                    function animateReveal() {
                        // Wait for GSAP to be fully loaded
                        const checkGSAP = setInterval(() => {
                            const gsapLib = window.gsap || (typeof window !== 'undefined' && window.gsap);
                            
                            if (gsapLib) {
                                clearInterval(checkGSAP);
                                
                                // Ensure overlay is visible before animating
                                loadingOverlay.classList.remove('hidden');
                                loadingOverlay.style.display = 'flex';
                                loadingOverlay.style.visibility = 'visible';
                                loadingOverlay.style.opacity = '1';
                                loadingOverlay.style.clipPath = 'inset(0% 0% 0% 0%)';
                                loadingOverlay.style.pointerEvents = 'auto'; // Block interactions behind
                                
                                console.log('Starting yellow stripe and video reveal animation');
                                
                                // IMMEDIATELY hide the Porsche logo (uiCogMesh) if it exists, to prevent flash
                                // Check for it right away and continuously until found
                                let logoHidden = false;
                                const hideLogoEarly = setInterval(() => {
                                    // Hide 3D logo (uiCogMesh)
                                    if (window.uiCogMesh && window.uiCogMesh.material && !logoHidden) {
                                        window.uiCogMesh.material.opacity = 0;
                                        window.uiCogMesh.material.transparent = true;
                                        window.uiCogMesh.material.needsUpdate = true;
                                        logoHidden = true;
                                        console.log('Porsche logo (uiCogMesh) hidden early (preventing flash)');
                                    }
                                    
                                    // Also hide SVG logos immediately
                                    const svgLogos = document.querySelectorAll('svg[class*="logo"], svg[id*="logo"], .porsche-logo svg, #porsche-logo svg');
                                    svgLogos.forEach(svg => {
                                        svg.style.opacity = '0';
                                    });
                                    
                                    // If we've hidden the 3D logo and found no more SVG logos, we can stop checking
                                    if (logoHidden && svgLogos.length === 0) {
                                        clearInterval(hideLogoEarly);
                                    }
                                }, 50);
                                
                                // Stop checking after 5 seconds (in case it never loads)
                                setTimeout(() => {
                                    clearInterval(hideLogoEarly);
                                }, 5000);
                                
                                // Store default camera position for zoom-in animation
                                // Default position from main.js: camera.position.set(.3825*maxDim,.3078*maxDim,.3825*maxDim)
                                // We need to get the current camera position from main.js
                                let defaultCameraPos = null;
                                let defaultControlsTarget = null;
                                
                                // Try to access camera and controls from main.js
                                const waitForCamera = setInterval(() => {
                                    if (window.camera && window.controls) {
                                        clearInterval(waitForCamera);
                                        // Store the default positions
                                        defaultCameraPos = window.camera.position.clone();
                                        defaultControlsTarget = window.controls.target.clone();
                                        
                                        // Calculate a position further away (1.8x distance for nice intro)
                                        const distance = defaultCameraPos.length();
                                        const direction = defaultCameraPos.clone().normalize();
                                        const startDistance = distance * 1.8;
                                        const startPos = direction.multiplyScalar(startDistance);
                                        
                                        // Set camera to start position (further away)
                                        window.camera.position.copy(startPos);
                                        window.camera.updateProjectionMatrix();
                                        
                                        console.log('Camera set to start position (further away)');
                                        
                                        // NOW start the camera zoom-in animation (once we have defaultCameraPos)
                                        const camPos = { x: window.camera.position.x, y: window.camera.position.y, z: window.camera.position.z };
                                        gsapLib.to(camPos, {
                                            x: defaultCameraPos.x,
                                            y: defaultCameraPos.y,
                                            z: defaultCameraPos.z,
                                            duration: 3,
                                            ease: 'power2.inOut',
                                            onUpdate: function() {
                                                if (window.camera) {
                                                    window.camera.position.set(camPos.x, camPos.y, camPos.z);
                                                    window.camera.updateProjectionMatrix();
                                                }
                                            },
                                            onStart: function() {
                                                console.log('Camera zoom-in started (3s zoom to default position)');
                                            }
                                        });
                                    }
                                }, 50);
                                
                                // Start fading in the 3D scene from black (3 second fade)
                                if (canvasContainer) {
                                    canvasContainer.style.opacity = '0'; // Start at black
                                    canvasContainer.style.visibility = 'visible'; // Make it visible but transparent
                                    gsapLib.to(canvasContainer, {
                                        opacity: 1,
                                        duration: 3,
                                        ease: 'power2.inOut',
                                        onStart: function() {
                                            console.log('3D scene fade-in started (3s fade from black)');
                                        },
                                        onComplete: function() {
                                            console.log('3D scene fade-in completed');
                                            
                                            // Scene is now fully visible - enable canvas interactions (camera zoom should also be complete)
                                            console.log('Enabling canvas interactions - scene is now active');
                                            if (canvasContainer) {
                                                canvasContainer.classList.add('loaded');
                                                canvasContainer.style.visibility = 'visible';
                                                // Enable all canvas elements for interactions
                                                const canvases = document.querySelectorAll('canvas');
                                                canvases.forEach(canvas => {
                                                    canvas.classList.add('ready');
                                                    canvas.style.setProperty('pointer-events', 'auto', 'important');
                                                });
                                                canvasContainer.style.setProperty('pointer-events', 'auto', 'important');
                                            }
                                            
                                            // Now fade in all UI elements (3 second fade)
                                            const uiElements = [
                                                document.getElementById('tooltip'),
                                                document.getElementById('music-player'),
                                                document.getElementById('book-button'),
                                                document.getElementById('rotate-button'),
                                                document.getElementById('info-button'),
                                                document.getElementById('fullscreen-button'),
                                                document.getElementById('part-container')
                                            ];
                                            
                                            uiElements.forEach(element => {
                                                if (element) {
                                                    // Skip tooltip - it's controlled by main.js and should remain hidden until hover
                                                    if (element.id === 'tooltip') {
                                                        return;
                                                    }
                                                    
                                                    // Disable CSS transitions temporarily so GSAP can control the animation
                                                    const originalTransition = element.style.transition;
                                                    element.style.transition = 'none';
                                                    
                                                    // Fade in over 3 seconds using GSAP
                                                    gsapLib.to(element, {
                                                        opacity: 1,
                                                        duration: 3,
                                                        ease: 'power2.inOut',
                                                        onStart: function() {
                                                            console.log('UI fade-in started for:', element.id);
                                                        },
                                                        onComplete: function() {
                                                            // Restore original transition behavior for hover effects
                                                            element.style.transition = originalTransition || '';
                                                            // Remove any inline opacity so CSS can control it via the faded-in class
                                                            element.style.opacity = '';
                                                            // Add faded-in class to ensure element stays visible (CSS uses !important)
                                                            element.classList.add('faded-in');
                                                            console.log('UI fade-in completed for:', element.id);
                                                            // Leave the element alone - let it work normally with hover effects
                                                        }
                                                    });
                                                }
                                            });
                                            
                                            // Also handle uiCogMesh if it exists (Porsche logotype)
                                            // This is a 3D object, so we'll need to check if window.uiCogMesh exists
                                            // and fade it in via its material opacity
                                            // Also check for SVG logo elements
                                            const checkLogo = setInterval(() => {
                                                // Try to find uiCogMesh (it should already be at opacity 0 from the early check)
                                                if (window.uiCogMesh && window.uiCogMesh.material) {
                                                    clearInterval(checkLogo);
                                                    // Ensure it's still invisible and transparent (should already be set, but make sure)
                                                    if (window.uiCogMesh.material.opacity !== 0) {
                                                        window.uiCogMesh.material.opacity = 0;
                                                    }
                                                    window.uiCogMesh.material.transparent = true;
                                                    window.uiCogMesh.material.needsUpdate = true;
                                                    // Fade it in
                                                    gsapLib.to(window.uiCogMesh.material, {
                                                        opacity: 1,
                                                        duration: 3,
                                                        ease: 'power2.inOut',
                                                        onStart: function() {
                                                            console.log('Porsche logo (uiCogMesh) fade-in started');
                                                        }
                                                    });
                                                }
                                                
                                                // Also check for any SVG elements that might be the logo
                                                const svgLogos = document.querySelectorAll('svg[class*="logo"], svg[id*="logo"], .porsche-logo svg, #porsche-logo svg');
                                                svgLogos.forEach(svg => {
                                                    // Hide SVG logos immediately if they're not already hidden
                                                    if (window.getComputedStyle(svg).opacity !== '0') {
                                                        svg.style.opacity = '0';
                                                    }
                                                    gsapLib.to(svg, {
                                                        opacity: 1,
                                                        duration: 3,
                                                        ease: 'power2.inOut'
                                                    });
                                                });
                                                
                                                if (svgLogos.length > 0) {
                                                    clearInterval(checkLogo);
                                                }
                                            }, 100);
                                            
                                            // Stop checking after 5 seconds
                                            setTimeout(() => {
                                                clearInterval(checkLogo);
                                            }, 5000);
                                            
                                            console.log('UI fade-in initiated (3s fade)');
                                        }
                                    });
                                }
                                
                                // Ensure video is playing
                                if (loadingVideo) {
                                    loadingVideo.play().catch(e => console.log('Video play attempt:', e));
                                }
                                
                                // Animate clip-path from top to bottom (simple reveal)
                                // Start: inset(0% 0% 0% 0%) = fully visible
                                // End: inset(100% 0% 0% 0%) = fully hidden (revealed from top)
                                const startValue = { value: 0 };
                                gsapLib.to(startValue, {
                                    value: 100,
                                    duration: 1.5,
                                    ease: 'power2.inOut',
                                    onUpdate: function() {
                                        const top = this.targets()[0].value;
                                        const clipPath = `inset(${top}% 0% 0% 0%)`;
                                        loadingOverlay.style.clipPath = clipPath;
                                        loadingOverlay.offsetHeight;
                                    },
                                    onStart: function() {
                                        console.log('Clip-path animation started (revealing from top to bottom)');
                                    },
                                    onComplete: () => {
                                        console.log('Clip-path animation completed');
                                        // DON'T enable canvas interactions here - wait until scene fade-in/camera zoom completes
                                        // Clean up after animation
                                        if (loadingVideo) {
                                            loadingVideo.pause();
                                            loadingVideo.src = '';
                                        }
                                        loadingOverlay.classList.add('hidden');
                                        loadingOverlay.style.display = 'none';
                                        loadingOverlay.style.pointerEvents = 'none';
                                    }
                                });
                            }
                        }, 50);
                        
                        // Timeout after 2 seconds if GSAP never loads
                        setTimeout(() => {
                            clearInterval(checkGSAP);
                            if (!loadingOverlay.classList.contains('hidden')) {
                                console.warn('GSAP not available, using fallback');
                                // Fallback: simple top-to-bottom reveal
                                loadingOverlay.style.transition = 'clip-path 1.5s ease-in-out';
                                loadingOverlay.style.clipPath = 'inset(100% 0% 0% 0%)';
                                setTimeout(() => {
                                    if (canvasContainer) {
                                        canvasContainer.classList.add('loaded');
                                        // Enable all canvas elements
                                        const canvases = document.querySelectorAll('canvas');
                                        canvases.forEach(canvas => {
                                            canvas.classList.add('ready');
                                            canvas.style.setProperty('pointer-events', 'auto', 'important');
                                        });
                                    }
                                    loadingOverlay.classList.add('hidden');
                                    if (loadingVideo) {
                                        loadingVideo.pause();
                                        loadingVideo.src = '';
                                    }
                                }, 1500);
                            }
                        }, 2000);
                    }
                    
                    animateReveal();
                    
                    // Canvas interactions will be enabled after animation completes
                    // (set in the GSAP onComplete callback)
                });
            }
        });
    </script>
    <!-- main.js and src/app.js preload immediately, but are revealed when Enter is clicked -->
    <script>
        // Mobile detection - DISABLED (mobile message turned off completely)
        function isMobileDevice() {
            // Always return false - mobile message is disabled
            return false;
        }
        
        // Mobile detection is disabled - no mobile message will appear
        // if (isMobileDevice()) {
        //     document.body.classList.add('mobile');
        //     document.getElementById('mobile-message').classList.add('active');
        //     // Disable pointer events on canvas to prevent interaction
        //     const canvas = document.querySelector('canvas');
        //     if (canvas) {
        //         canvas.style.pointerEvents = 'none';
        //     }
        // }
        
        // Follow mouse with cross (only on non-mobile)
        if (!isMobileDevice()) {
            const cross = document.getElementById('cursor-cross');
            window.addEventListener('mousemove', (e) => {
                cross.style.left = e.clientX + 'px';
                cross.style.top = e.clientY + 'px';
            });
        }
    </script>

<script>
  document.addEventListener('visibilitychange', function() {
    if (window.gsap && gsap.globalTimeline) {
      if (document.hidden) { gsap.globalTimeline.pause(); }
      else { gsap.globalTimeline.resume(); }
    }
  });
</script>

</body>
</html>

